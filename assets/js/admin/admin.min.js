"use strict";!function(c,s,i){var r={};c(i).ready(function(){c(".merchant-module-page-setting-field").each(function(){var n,e,o=c(this);o.data("condition")&&o.data("condition").length&&(n=o.data("condition"),(e=c('input[name="merchant['+n[0]+']"],select[name="merchant['+n[0]+']"]')).length)&&e.on("change merchant.change",function(e){var a=c(this),t=!1;switch(n[1]){case"==":"radio"!==a.attr("type")&&"checkbox"!==a.attr("type")||a.is(":checked")&&a.val()==n[2]&&(t=!0),a.is("select")&&a.val()==n[2]&&(t=!0);break;case"any":"radio"!==a.attr("type")&&"checkbox"!==a.attr("type")||a.is(":checked")&&n[2].split("|").includes(a.val())&&(t=!0),a.is("select")&&n[2].split("|").includes(a.val())&&(t=!0)}t?o.removeClass("merchant-hide").addClass("merchant-show"):o.removeClass("merchant-show").addClass("merchant-hide")}).trigger("merchant.change")});var e=c(".merchant-module-page-ajax-form"),t=c(".merchant-module-page-ajax-header"),n=(c(".merchant-module-save-button"),c(".merchant-module-page-content").on("change keypress change.merchant",":input:not(.merchant-module-question-answer-textarea)",function(){r.show_save||(t.addClass("merchant-show"),t.removeClass("merchant-saving"),r.show_save=!0)}),e.ajaxForm({beforeSubmit:function(){t.addClass("merchant-saving")},success:function(){var a;t.removeClass("merchant-show"),r.show_save=!1,c(".merchant-module-action").hasClass("merchant-enabled")||((a=c(".merchant-module-alert")).addClass("merchant-show"),c(i).off("click.merchant-alert-close"),c(i).on("click.merchant-alert-close",function(e){c(e.target).closest(".merchant-module-alert-wrapper").length||(a.removeClass("merchant-show"),c(i).off("click.merchant-alert-close"))}))}}),c(".merchant-module-question-answer-button").on("click",function(e){e.preventDefault();c(this);e=c(".merchant-module-question-answer-textarea");c(".merchant-module-question-answer-dropdown").removeClass("merchant-show"),c(".merchant-module-question-thank-you-dropdown").addClass("merchant-show"),s.wp.ajax.post("merchant_module_feedback",{subject:e.data("subject"),message:e.val(),nonce:s.merchant.nonce})}),c(".merchant-module-page-button-action-activate").on("click",function(e){e.preventDefault(),c(".merchant-module-question-list-dropdown").removeClass("merchant-show"),c(".merchant-module-question-answer-dropdown").removeClass("merchant-show"),c(".merchant-module-question-answer-form").removeClass("merchant-show"),c(".merchant-module-question-answer-title").removeClass("merchant-show"),c(".merchant-module-question-thank-you-dropdown").removeClass("merchant-show"),c(".merchant-module-question-answer-textarea").val(""),s.wp.ajax.post("merchant_module_activate",{module:c(this).data("module"),nonce:s.merchant.nonce}).done(function(){c(".merchant-module-action").addClass("merchant-enabled")})}),c(".merchant-module-page-button-action-deactivate").on("click",function(e){e.preventDefault(),s.wp.ajax.post("merchant_module_deactivate",{module:c(this).data("module"),nonce:s.merchant.nonce}).done(function(){c(".merchant-module-action").removeClass("merchant-enabled"),c(".merchant-module-question-list-dropdown").addClass("merchant-show")})}),c(".merchant-module-question-list-dropdown li").on("click",function(e){var a=c(this),t=a.data("answer-target"),t=c('[data-answer-title="'+t+'"]');t.length?(t.addClass("merchant-show").siblings().removeClass("merchant-show"),c(".merchant-module-question-answer-dropdown").addClass("merchant-show"),c(".merchant-module-question-answer-textarea").attr("data-subject",a.text().trim())):(c(".merchant-module-question-thank-you-dropdown").addClass("merchant-show"),c(".merchant-module-question-answer-dropdown").removeClass("merchant-show")),c(".merchant-module-question-answer-textarea").val(""),c(".merchant-module-question-list-dropdown").removeClass("merchant-show")}),c(".merchant-module-dropdown-close").on("click",function(e){e.preventDefault(),c(this).closest(".merchant-module-dropdown").removeClass("merchant-show")}),c(".merchant-module-page-button-deactivate").on("click",function(e){e.preventDefault();c(this);var a=c(".merchant-module-deactivate-dropdown");a.toggleClass("merchant-show"),c(i).off("click.merchant-close"),c(i).on("click.merchant-close",function(e){c(e.target).closest(".merchant-module-deactivate").length||(a.removeClass("merchant-show"),c(i).off("click.merchant-close"))})}),c(".merchant-range").each(function(){var e=c(this),n=e.find(".merchant-range-input"),o=e.find(".merchant-range-number-input");n.on("change input merchant.range merchant-init.range",function(e){var a=c(this),e=("merchant"===e.type?o:a).val()||0,t=a.attr("min")||0,t=(e-t)/((a.attr("max")||1)-t)*100;a.css({background:"linear-gradient(to right, #3858E9 0%, #3858E9 "+t+"%, #ddd "+t+"%, #ddd 100%)"}),n.val(e),o.val(e)}).trigger("merchant-init.range"),o.on("change input blur",function(){n.hasClass("merchant-range-input")&&n.val(c(this).val()).trigger("merchant.range")})}),c(".merchant-color").each(function(){var a,t,e=c(this),n=e.find(".merchant-color-picker"),o=e.find(".merchant-color-input");n.on("click",function(){var e=c("body,html");e.addClass("merchant-height-auto"),a?t.setColor(o.val()):((t=new Pickr({el:n.get(0),container:"body",theme:"merchant",appClass:"merchant-pcr-app",default:o.val()||"#212121",swatches:["#000000","#F44336","#E91E63","#673AB7","#03A9F4","#8BC34A","#FFEB3B","#FFC107","#FFFFFF"],sliders:"h",useAsButton:!0,components:{hue:!0,preview:!0,opacity:!0,interaction:{input:!0,clear:!0}},i18n:{"btn:clear":"Default"}})).on("change",function(e){e=(1===e.a?(t.setColorRepresentation("HEX"),e.toHEXA()):(t.setColorRepresentation("RGBA"),e.toRGBA())).toString(0);n.css({"background-color":e}),o.val()!==e&&o.val(e).trigger("change.merchant")}),t.on("clear",function(){var e=n.data("default-color");e?t.setColor(e):(n.css({"background-color":"white"}),o.val(""))}),t.on("hide",function(){e.removeClass("merchant-height-auto")}),n.data("pickr",t),setTimeout(function(){t.show()}),a=!0)}),o.on("change keyup",function(){var e=c(this).val();n.css({"background-color":e})})}),c(".merchant-sortable").each(function(){var e=c(this),a=e.find(".merchant-sortable-input");c(e.find("ul.merchant-sortable-list").first()).sortable({update:function(){a.val(n(e)).trigger("change.merchant")}}).disableSelection().find("li").each(function(){c(this).find("i.visibility").click(function(){c(this).toggleClass("dashicons-visibility-faint").parents("li:eq(0)").toggleClass("invisible")})}).click(function(){a.val(n(e)).trigger("change.merchant")})}),function(e){var e=c(e.find("li")),a=[];return _.each(e,function(e){c(e).hasClass("invisible")||a.push(c(e).data("value"))}),JSON.stringify(a)}),o=(c(".merchant-module-page-setting-field-gallery").each(function(){var n,o=c(this),e=o.find(".merchant-gallery-button"),i=o.find(".merchant-gallery-input"),r=o.find(".merchant-gallery-images"),a=o.find(".merchant-gallery-remove");r.sortable({helper:"original",update:function(e,a){var t=[];r.find(".merchant-gallery-image").each(function(){t.push(c(this).data("item-id"))}),i.val(t.join(",")).trigger("change")}});a.on("click",function(e){e.preventDefault(),c(this).parent().remove();var a=[];r.find(".merchant-gallery-image").each(function(){a.push(c(this).data("item-id"))}),i.val(a.join(",")).trigger("change")}),e.on("click",function(e){c(this);var a=i.val(),t=a?"edit":"add";e.preventDefault(),void 0!==s.wp&&s.wp.media&&s.wp.media.gallery&&("add"==t?(n=s.wp.media({library:{type:"image"},frame:"post",state:"gallery",multiple:!0})).open():n=s.wp.media.gallery.edit('[gallery ids="'+a+'"]'),n.on("update",function(e){r.empty();e=e.models.map(function(e){var e=e.toJSON(),a=(e.sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url?e.sizes.thumbnail:e).url;return r.append('<div class="merchant-gallery-image" data-item-id="'+e.id+'"><i class="merchant-gallery-remove dashicons dashicons-no-alt"></i><img src="'+a+'" /></div>'),e.id});i.val(e.join(",")).trigger("change"),o.find(".merchant-gallery-remove").on("click",function(e){e.preventDefault(),c(this).parent().remove();var a=[];r.find(".merchant-gallery-image").each(function(){a.push(c(this).data("item-id"))}),i.val(a.join(",")).trigger("change")})}))})}),c(".merchant-module-page-setting-field-upload").each(function(){var t,n=c(this),e=n.find(".merchant-upload-button"),o=n.find(".merchant-upload-input"),i=n.find(".merchant-upload-wrapper");n.find(".merchant-upload-remove").on("click",function(e){e.preventDefault(),c(this).parent().remove(),o.val("").trigger("change")}),e.on("click",function(e){e.preventDefault(),void 0!==s.wp&&s.wp.media&&((t=t||s.wp.media({library:{type:"image"}})).open(),t.on("select",function(){i.empty();var e=t.state().get("selection").first().attributes,a=(e.sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url?e.sizes.thumbnail:e).url;i.append('<div class="merchant-upload-image"><i class="merchant-upload-remove dashicons dashicons-no-alt"></i><img src="'+a+'" /></div>'),o.val(e.id).trigger("change"),n.find(".merchant-upload-remove").on("click",function(e){e.preventDefault(),c(this).parent().remove(),o.val("").trigger("change")})}))})}),c(".merchant-animated-buttons").each(function(){var e,a,t=c(this).find("label"),n=c(".merchant-animation-demo");t.on("click",function(){n.removeClass("merchant-animation-"+e),n.removeClass("merchant-animation-"+a),e=c(this).find("input").attr("value"),setTimeout(function(){n.addClass("merchant-animation-"+e)},100),setTimeout(function(){n.removeClass("merchant-animation-"+e)},1e3)}),t.mouseover(function(){n.removeClass("merchant-animation-"+e),a=c(this).find("input").attr("value"),n.addClass("merchant-animation-"+a)}).mouseout(function(){n.removeClass("merchant-animation-"+a)})}),c(".merchant-notifications-sidebar")),a=(o.length&&(c(".merchant-notifications").on("click",function(e){e.preventDefault();var a=c(this),e=o.find(".merchant-notification:first-child .merchant-notification-date").data("raw-date");o.toggleClass("opened"),a.hasClass("read")||c.post(s.merchant.ajax_url,{action:"merchant_notifications_read",nonce:s.merchant.nonce,latest_notification_date:e},function(e){e.success&&setTimeout(function(){a.addClass("read")},2e3)})}),c(s).on("scroll",function(){60<s.pageYOffset&&(o.addClass("closing"),setTimeout(function(){o.removeClass("opened"),o.removeClass("closing")},300))}),c(".merchant-notifications-sidebar-close").on("click",function(e){e.preventDefault(),o.addClass("closing"),setTimeout(function(){o.removeClass("opened"),o.removeClass("closing")},300)})),c(".merchant-module-alert"));a.length&&a.find(".merchant-module-alert-close").on("click",function(e){e.preventDefault(),a.removeClass("merchant-show"),c(i).off("click.merchant-alert-close")})})}(jQuery,window,document);